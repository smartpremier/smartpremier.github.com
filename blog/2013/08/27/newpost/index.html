
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>멀티노드 스톰 클러스터 구동하기 - smartpremier의 큰개소리</title>
  <meta name="author" content="smartpremier">

  
  <meta name="description" content="이 예제는 CentOS 6.3 환경에서 Storm을 분산 멀티 클러스터 환경에 어떻게 설치하고 설정하는지 자세히 소개한다. Storm을 실행하기 위해 필요한 ZooKeeper와 Storm의 각 데몬 프로세스를 관리 감독할 Supervisord도 다룬다. Storm &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://smartpremier.github.io/blog/2013/08/27/newpost">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="smartpremier의 큰개소리" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">smartpremier의 큰개소리</a></h1>
  
    <h2>Return to basic.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:smartpremier.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">멀티노드 스톰 클러스터 구동하기</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-08-27T00:36:00+09:00" pubdate data-updated="true">Aug 27<span>th</span>, 2013</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>이 예제는 CentOS 6.3 환경에서 Storm을 분산 멀티 클러스터 환경에 어떻게 설치하고 설정하는지 자세히 소개한다. Storm을 실행하기 위해 필요한 ZooKeeper와 Storm의 각 데몬 프로세스를 관리 감독할 Supervisord도 다룬다. Storm 클러스터 구축을 완료하면 정상 동작을 테스트하기 위해 예제 Topology를 실행하는 방법과 그에 따른 일반적인 운영이슈를 FAQ방식으로 정리하며 글을 마무리 할 예정이다.</p>

<h1>다루게 되는 내용들</h1>

<ul>
<li>Storm 멀티 노드 클러스터를 설치하고 설정하기</li>
<li>Storm에서 사용할 ZooKeeper클러스터 설치하기(ZooKeeper클러스터는 single-node로 구성)</li>
<li>Storm 마스터 노드 1대에서 Storm의 Nimbus와 UI 데몬 구동하기</li>
<li>Storm 슬레이브 노드 3대에서 Supervisor 구동하기</li>
<li>Supervisord를 사용하여 Storm 마스터 노드와 슬레이브 노드 관리하기</li>
<li>구축된 Storm 클러스터에 예제 Topology를 실행하기</li>
</ul>


<h1>소프트웨어 버전</h1>

<ul>
<li>CentOS release 6.3 x86_64</li>
<li>Storm 0.8.2 release</li>
</ul>


<h1>Storm 클러스터 구성 개요</h1>

<ul>
<li><code>zk01</code> : Zookeeper 클러스터는 단 한개의 ZooKeeper 노드로 구성한다.(서비스환경에서는 최소 3대구성)</li>
<li><code>storm01</code> : Storm 클러스터의 마스터 노드. Nimbus와 UI 데몬 실행</li>
<li><code>storm{02, 03,...,n}</code> : Storm 클러스터의 슬레이브 노드. 실제 작성한 Storm Application을 실행하는worker 프로세스와 이를 관리하는 Supervisor 데몬 실행.</li>
</ul>


<p>Storm의 슬레이브 노드는 자신이 구동되는 시점에 ZooKeeper에 자신의 정보를 기록한다. 이렇게 기록된 슬레이브 노드들에 대한 정보는 마스터 노드가 참조하여 현재 가용한 클러스터를 구성한다. 따라서 슬레이브 노드가 1대 이든 수백대이든 전혀 문제가 되지 않는 구조를 가진다. 따라서 우리의 예제는 슬레이브 노드의 수와 무관하게 잘 동작할 것이다. 우리가 해줘야하는 것은 그저 슬레이브 노드를 설치하고 설정하면 된다.이후 동작은 Storm이 자동적으로 알아서 동작한다.</p>

<p>Storm 클러스터 구성에 앞서 간략하게 스톰의 구성요소들에 대해 소개한다.</p>

<h2>Background: Storm 아키텍처</h2>

<p>Storm은 클러스터내에서 2가지 타입의 노드로 구별된다.</p>

<ol>
<li><p><strong>마스터 노드</strong> worker 노드에 작업을 할당하고 클러스터를 모니터링하고, 클러스터에 애플리케이션을 배포하는 역할을 하는 Nimbus라 불리는 프로세스가 실행되고 있는 노드이다.하둡의 JobTracker와 유사하다.</p></li>
<li><p><strong>워커 노드</strong> Supervisor 라 불리는 데몬 프로세스가 실행되고 있는 노드이다. Supervisor는 Nimbus로 부터 작업이 할당되면 필요한 만큼 워커 프로세스를 생성하여 시작시키고 작업이 종료되면 워커 프로세스를 종료시키는 기능을 담당한다. 각 워커 프로세스는 Topology의 한 부분을 수행한다. Supervisor는 하둡의 TaskTracker와 유사하다.</p></li>
</ol>


<h2>Networking 구성</h2>

<p>모든 노드는 DNS에 등록된 호스트명을 통해 노드간 접속을 하게된다. DNS 구성은 추후 다른 섹션을 통해 소개하겠다. 일단은 편의를 위하여 <code>/etc/hosts</code> 파일에 필요한 노드 정보를 설정한다.
<figcaption><span>Host 구성 정보</span></figcaption></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>192.168.56.101   storm01.bigdata.com storm01 <span class="c"># nimbus</span>
</span><span class='line'>192.168.56.102    storm02.bigdata.com storm02 <span class="c"># supervisor</span>
</span><span class='line'>192.168.56.103    storm03.bigdata.com storm03 <span class="c"># supervisor</span>
</span><span class='line'>192.168.56.104    storm04.bigdata.com storm04 <span class="c"># supervisor</span>
</span><span class='line'>192.168.56.105    zk01.bigdata.com    zk01 <span class="c"># zookeeper</span>
</span></code></pre></td></tr></table></div></figure>


<h1>ZooKeeper 설치하기</h1>

<h2>Storm 과 ZooKeeper</h2>

<p>Storm은 클러스터 내의 많은 액터들(Nimbus, Supervisor..)과 연동을 위해 ZooKeeper를 이용한다.</p>

<h2>설치하기</h2>

<p>설치는 크게 Cluderad yum repo를 이용하는 방법과 바이너리 Download를 이용하는 방법이 있다.
편한 방법으로 설치한다. 이후 설정 부분은 동일하게 작업하면 된다.</p>

<h1>. Cloudera CDH4 YUM Repo를 이용한 설치</h1>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># Add Cloudera&#39;s CDH4 Yum Repository</span>
</span><span class='line'>wget http://archive.cloudera.com/cdh4/one-click-install/redhat/6/x86_64/cloudera-cdh-4-0.x86_64.rpm
</span><span class='line'>sudo yum --nogpgcheck localinstall cloudera-cdh-4-0.x86_64.rpm
</span><span class='line'>sudo rpm --import http://archive.cloudera.com/cdh4/redhat/6/x86_64/cdh/RPM-GPG-KEY-cloudera
</span><span class='line'>wget http://archive.cloudera.com/cdh4/redhat/6/x86_64/cdh/cloudera-cdh4.repo /etc/yum.repos.d/
</span><span class='line'>
</span><span class='line'><span class="c"># check Cloudera CDH4 repository</span>
</span><span class='line'>sudo yum repolist | grep cloudera-cdh4
</span><span class='line'>
</span><span class='line'><span class="c"># install zookeeper</span>
</span><span class='line'>sudo yum install zookeeper zookeeper-server
</span></code></pre></td></tr></table></div></figure>


<h1>. Binary Download를 이용한 설치</h1>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">ZK_VERSION</span><span class="o">=</span>3.4.5
</span><span class='line'>wget http://apache.tt.co.kr/zookeeper/zookeeper-<span class="k">${</span><span class="nv">ZK_VERSION</span><span class="k">}</span>/zookeeper-<span class="k">${</span><span class="nv">ZK_VERSION</span><span class="k">}</span>.tar.gz
</span><span class='line'>tar xvfz zookeeper-<span class="k">${</span><span class="nv">ZK_VERSION</span><span class="k">}</span>.tar.gz
</span></code></pre></td></tr></table></div></figure>


<h1>. 설치 완료 후 설정하기</h1>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">cd</span> <span class="k">${</span><span class="nv">ZOOKEEPER_HOME</span><span class="k">}</span>
</span><span class='line'>cp conf/zoo_sample.cfg conf/zoo.cfg
</span></code></pre></td></tr></table></div></figure>


<p>설정은 꼭 필요한 내용들만 다룬다. 기본 설정을 유지하되 아래의 내용을 <code>zoo.cfg</code>파일에 맨 마지막에 추가한다.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># Enable regular purging of old data and transaction logs every 24 hours</span>
</span><span class='line'>autopurge.purgeInterval<span class="o">=</span>24
</span><span class='line'>autopurge.snapRetainCount<span class="o">=</span>5
</span></code></pre></td></tr></table></div></figure>


<h2>ZooKeeper 실행하기</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">cd</span> <span class="k">${</span><span class="nv">ZOOKEEPER_HOME</span><span class="k">}</span>
</span><span class='line'>bin/zkServer.sh start
</span></code></pre></td></tr></table></div></figure>


<h2>ZooKeeper 동작 확인법</h2>

<p>ZooKeeper가 실행되고 나면 <a href="http://zookeeper.apache.org/doc/current/zookeeperAdmin.html#sc_zkCommands">four letter commands</a>라 불리는 간단한 명령들을 통해 동작들을 확인할 수 있다.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">echo </span>ruok | nc zk01 2181
</span><span class='line'>imok
</span><span class='line'>
</span><span class='line'><span class="nb">echo </span>stat | nc zk01 2181
</span><span class='line'>Zookeeper version: 3.4.5-1392090, built on 09/30/2012 17:52 GMT
</span></code></pre></td></tr></table></div></figure>


<h1>Storm 설치하기</h1>

<h2>관련 프로그램 설치하기</h2>

<p>마스터와 슬레이브를 포함한 모든 스톰 클러스터 노드는 아래와 같은 프로그램이 반드시 설치되어 있어야 한다.</p>

<p><strong> Java 6+ </strong>
JDK6 이상의 버전이 설치되어 있어야 한다.</p>

<p><strong> ZeroMQ 2.1.7 </strong>
ZeroMQ는 보편적인 메시징 미들웨어 제품들이 제공해온 다양한 기능을 제공하는 표준 소켓 인터페이스 라이브러리로 Storm 클러스터내에 task 와 task 간 통신을 위해 이를 이용한다.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo yum install gcc gcc-c++ libuuid_devel
</span></code></pre></td></tr></table></div></figure>


<p>아래의 명령들은 ZeroMQ 소스를 빌드하여 <code>/usr/local/lib</code> 아래에 설치하게 된다.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">cd</span> /tmp
</span><span class='line'>wget http://download.zeromq.org/zeromq-2.1.7.tar.gz
</span><span class='line'>tar -xzf zeromq-2.1.7.tar.gz
</span><span class='line'><span class="nb">cd </span>zeromq-2.1.7
</span><span class='line'>./configure
</span><span class='line'>make
</span><span class='line'>sudo make install
</span></code></pre></td></tr></table></div></figure>


<p><strong> JZMQ </strong>
JZMQ는 ZeroMQ의 자바 바인딩이다.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">cd</span> /tmp
</span><span class='line'>git clone https://github.com/nathanmarz/jzmq.git
</span><span class='line'><span class="nb">cd </span>jzmq
</span><span class='line'>./autogen.sh
</span><span class='line'>./configure
</span><span class='line'>make
</span><span class='line'>sudo make install
</span></code></pre></td></tr></table></div></figure>


<p><strong> Python 2.6.6 </strong>
Python 2.6.6은 CentOS 6.3에 기본적으로 설치되어 있다. 설치가 되어 있지 않다면 설치한다.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo yum install python
</span></code></pre></td></tr></table></div></figure>


<p><strong> Unzip </strong>
Unzip은 CentOS 6.3에 기본적으로 설치되어 있다. 설치가 되어 있지 않다면 설치한다.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo yum install unzip
</span></code></pre></td></tr></table></div></figure>


<h2>Storm 설치하기</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">cd</span> /opt
</span><span class='line'>mkdir storm
</span><span class='line'>wget https://github.com/nathanmarz/storm/archive/0.8.2.zip
</span><span class='line'>unzip 0.8.2 -d storm-0.8.2
</span></code></pre></td></tr></table></div></figure>


<h2>Storm Local working directory 생성하기</h2>

<p>Nimbus와 Supervisor 데몬이 jar 파일이나 설정과 같은 상태 정보를 저장하기 위한 로컬 디렉토리가 필요하다. <code>/app/storm</code>을 생성하여 이후 설정시에 <code>storm.local.dir</code>에 설정해 준다.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo mkdir -p /app/storm
</span><span class='line'>sudo chown -R <span class="k">${</span><span class="nv">STORM</span><span class="p">.USER</span><span class="k">}</span> /app/storm
</span><span class='line'>sudo chmod 750 /app/storm
</span></code></pre></td></tr></table></div></figure>


<p>Storm 데몬을 실행하고 나면 다음과 같은 디렉토리가 구성된다.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># on master node (nimbus1)</span>
</span><span class='line'><span class="nv">$ </span>sudo tree /app/storm
</span><span class='line'>/app/storm
</span><span class='line'>+--- nimbus
</span><span class='line'>     +--- inbox
</span></code></pre></td></tr></table></div></figure>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># on slave nodes</span>
</span><span class='line'><span class="nv">$ </span>sudo tree /app/storm
</span><span class='line'>/app/storm
</span><span class='line'>+--- supervisor
</span><span class='line'>     +--- isupervisor
</span><span class='line'>     |    +--- 1368698566625
</span><span class='line'>     |    +--- 1368698566625.version
</span><span class='line'>     +--- localstate
</span><span class='line'>     |    +--- 1368698594679
</span><span class='line'>     |    +--- 1368698594679.version
</span><span class='line'>     |    +--- 1368698597685
</span><span class='line'>     |    +--- 1368698597685.version
</span><span class='line'>     |    +--- 1368698597689
</span><span class='line'>     |    +--- 1368698597689.version
</span><span class='line'>     |    +--- 1368698597696
</span><span class='line'>     |    +--- 1368698597696.version
</span><span class='line'>     +--- tmp
</span></code></pre></td></tr></table></div></figure>


<p>지금 설정한 로컬 디렉토리는 중요한 역할에 이용된다. Supervisor 데몬이 크래싱되거나 비정상 종료되는 된 후 다시 시작할 때 이 로컬 디렉토리의 참조하여 종료 이전 마지막 프로세스가 기록한 시점 이후부터 다시 읽어들여 처리를 계속 수행하게 된다.</p>

<h2>Storm 설정하기</h2>

<p>Storm의 설정파일은 <code>${STORM_HOME}/conf/storm.yaml</code>이다. <code>${STORM_HOME}/conf/storm.yaml</code>의 설정된 내용은 defaults.yaml파일에 설정된 내용을 대체하게 된다.</p>

<figure class='code'><figcaption><span>${STORM_HOME}/conf/storm.yaml&#8220;` 파일을 열어 아래 내용을 참조하여 자신의 환경에 맞는 적절한 값으로 설정한다. 아래 내용은 마스터와 슬레이브 모든 노드에 동일하게 적용해야 한다.</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="sb">```</span> bash
</span><span class='line'>storm.zookeeper.servers:
</span><span class='line'>    - <span class="s2">&quot;zk01&quot;</span>
</span><span class='line'>
</span><span class='line'>nimbus.host: <span class="s2">&quot;storm01&quot;</span>
</span><span class='line'>nimbus.childopts: <span class="s2">&quot;-Xmx1024m -Djava.net.preferIPv4Stack=true&quot;</span>
</span><span class='line'>
</span><span class='line'>ui.childopts: <span class="s2">&quot;-Xmx768m -Djava.net.preferIPv4Stack=true&quot;</span>
</span><span class='line'>
</span><span class='line'>supervisor.childopts: <span class="s2">&quot;-Djava.net.preferIPv4Stack=true&quot;</span>
</span><span class='line'>worker.childopts: <span class="s2">&quot;-Xmx768m -Djava.net.preferIPv4Stack=true&quot;</span>
</span><span class='line'>
</span><span class='line'>storm.local.dir: <span class="s2">&quot;/app/storm&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>이 외의 주요한 설정 내용은 아래와 같다.
 &ndash; <code>java.library.path</code> &ndash; ZeroMQ와 JZMQ 등 Strom이 사용하는 네이티브 라이브러리가 위치한 경로를 정해준다. ex)<code>/usr/local/lib</code>
 &ndash; <code>supervisor.slots.ports</code> &ndash; 한 개의 Supervisor에서 몇 개의 worker process를 실행할지 설정한다. 예를 들어, 아마존 EC2의 small instance 라면 port = 1 정로도 설정하고, large나 2xlarge와 같은 경우 좀 더 설정한다. 기본적으로 Storm은 6700-6703까지 4개의 tcp port를 사용한다. 한 노드(머신)에서 4개의 worker process가 실행된다는 의미이다. Storm UI에서 이런 worker들은 slots로 표시되어 나타난다.
마지막으로 이런 worker ports는 worker들이 실제로 실행되는 동안에만 사용되게 되며, cluster가 idle상태라면 worker들은 실행되지 않는다.</p>

<h2>Storm cluster 실행 테스트</h2>

<p>이제까지 설치하고 설정한 Storm cluster가 잘 동작하는지 직접 테스트를 해보자. 이를 통해 Storm 설정이 올바르게 적용되었는지 확인해 볼 수 있다.</p>

<p><strong> Nimbus 데몬 실행하기 </strong></p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">smartpremier</span></span>

      








  


<time datetime="2013-08-27T00:36:00+09:00" pubdate data-updated="true">Aug 27<span>th</span>, 2013</time>
      


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://smartpremier.github.io/blog/2013/08/27/newpost/" data-via="" data-counturl="http://smartpremier.github.io/blog/2013/08/27/newpost/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/08/27/newpost/">멀티노드 스톰 클러스터 구동하기</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - smartpremier -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
